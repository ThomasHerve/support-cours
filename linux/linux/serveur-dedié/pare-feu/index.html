
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Linux - Configuration des Pare-feu : UFW et iptables - Cours DevOps et Linux</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#linux-configuration-des-pare-feu-ufw-et-iptables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Cours DevOps et Linux" class="md-header__button md-logo" aria-label="Cours DevOps et Linux" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 22v-2h3v-3h2v3.5c0 .39-.16.74-.46 1.04s-.65.46-1.04.46zM7 22H3.5c-.39 0-.74-.16-1.04-.46S2 20.89 2 20.5V17h2v3h3zM17 2h3.5c.39 0 .74.16 1.04.46s.46.65.46 1.04V7h-2V4h-3zM7 2v2H4v3H2V3.5c0-.39.16-.74.46-1.04S3.11 2 3.5 2zm6 15.25 4-2.3v-4.59l-4 2.3zm-1-6.33 4-2.29-4-2.35-4 2.35zm-5 4.03 4 2.3v-4.59l-4-2.3zm11.23-7.36c.5.32.77.75.77 1.32v6.32c0 .57-.27 1-.77 1.32l-5.48 3.18q-.75.48-1.5 0l-5.48-3.18c-.5-.32-.77-.75-.77-1.32V8.91c0-.57.27-1 .77-1.32l5.48-3.18c.25-.13.5-.19.75-.19s.5.06.75.19z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cours DevOps et Linux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Linux - Configuration des Pare-feu : UFW et iptables
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../" class="md-tabs__link">
          
  
    
  
  Linux

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../docker/" class="md-tabs__link">
          
  
    
  
  Docker

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Cours DevOps et Linux" class="md-nav__button md-logo" aria-label="Cours DevOps et Linux" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 22v-2h3v-3h2v3.5c0 .39-.16.74-.46 1.04s-.65.46-1.04.46zM7 22H3.5c-.39 0-.74-.16-1.04-.46S2 20.89 2 20.5V17h2v3h3zM17 2h3.5c.39 0 .74.16 1.04.46s.46.65.46 1.04V7h-2V4h-3zM7 2v2H4v3H2V3.5c0-.39.16-.74.46-1.04S3.11 2 3.5 2zm6 15.25 4-2.3v-4.59l-4 2.3zm-1-6.33 4-2.29-4-2.35-4 2.35zm-5 4.03 4 2.3v-4.59l-4-2.3zm11.23-7.36c.5.32.77.75.77 1.32v6.32c0 .57-.27 1-.77 1.32l-5.48 3.18q-.75.48-1.5 0l-5.48-3.18c-.5-.32-.77-.75-.77-1.32V8.91c0-.57.27-1 .77-1.32l5.48-3.18c.25-.13.5-.19.75-.19s.5.06.75.19z"/></svg>

    </a>
    Cours DevOps et Linux
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../docker/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-requis" class="md-nav__link">
    <span class="md-ellipsis">
      Pré-requis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#partie-1-utilisation-de-ufw" class="md-nav__link">
    <span class="md-ellipsis">
      Partie 1 : Utilisation de UFW
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Partie 1 : Utilisation de UFW">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#etape-11-verifier-si-ufw-est-installe" class="md-nav__link">
    <span class="md-ellipsis">
      Étape 1.1 : Vérifier si UFW est installé
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etape-12-configurer-les-regles-de-base" class="md-nav__link">
    <span class="md-ellipsis">
      Étape 1.2 : Configurer les règles de base
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etape-13-activer-ufw" class="md-nav__link">
    <span class="md-ellipsis">
      Étape 1.3 : Activer UFW
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etape-14-tester-la-configuration-ufw-en-local" class="md-nav__link">
    <span class="md-ellipsis">
      Étape 1.4 : Tester la configuration UFW en local
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#partie-2-utilisation-de-iptables" class="md-nav__link">
    <span class="md-ellipsis">
      Partie 2 : Utilisation de iptables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Partie 2 : Utilisation de iptables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#etape-21-verifier-si-iptables-est-installe" class="md-nav__link">
    <span class="md-ellipsis">
      Étape 2.1 : Vérifier si iptables est installé
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etape-22-configurer-des-regles-simples" class="md-nav__link">
    <span class="md-ellipsis">
      Étape 2.2 : Configurer des règles simples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etape-23-sauvegarder-et-restaurer-les-regles" class="md-nav__link">
    <span class="md-ellipsis">
      Étape 2.3 : Sauvegarder et restaurer les règles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etape-24-tester-la-configuration-iptables-en-local" class="md-nav__link">
    <span class="md-ellipsis">
      Étape 2.4 : Tester la configuration iptables en local
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="linux-configuration-des-pare-feu-ufw-et-iptables">Linux - Configuration des Pare-feu : UFW et iptables</h1>
<p><img alt="Tutorial Cover" src="../assets/firewall.jpg" /></p>
<h2 id="introduction">Introduction</h2>
<p>Les pare-feu sont des outils essentiels pour sécuriser un serveur Linux. Ce guide explique en détail la configuration des deux principaux pare-feu : <strong>UFW</strong> (Uncomplicated Firewall) et <strong>iptables</strong>. Nous explorerons leurs fonctionnalités, leur configuration et leur validation.</p>
<hr />
<h2 id="pre-requis">Pré-requis</h2>
<ul>
<li>Une machine Linux avec un accès root ou sudo.</li>
<li>Les outils <strong>UFW</strong> et <strong>iptables</strong> installés.</li>
<li>Une compréhension de base des ports et des protocoles réseau.</li>
</ul>
<hr />
<h2 id="partie-1-utilisation-de-ufw">Partie 1 : Utilisation de UFW</h2>
<p><strong>UFW</strong> est une interface simplifiée pour gérer iptables, conçue pour les administrateurs système novices.</p>
<h3 id="etape-11-verifier-si-ufw-est-installe">Étape 1.1 : Vérifier si UFW est installé</h3>
<p>Exécutez la commande suivante pour vérifier si UFW est installé :</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>status
</span></code></pre></div>
<ul>
<li>Si UFW est installé, vous verrez un statut (par exemple <code>active</code> ou <code>inactive</code>).</li>
<li>Sinon, installez-le :
  <div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ufw
</span></code></pre></div></li>
</ul>
<hr />
<h3 id="etape-12-configurer-les-regles-de-base">Étape 1.2 : Configurer les règles de base</h3>
<ol>
<li>
<p><strong>Autoriser les connexions SSH (indispensable)</strong> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span>ssh
</span></code></pre></div></p>
</li>
<li>
<p><strong>Autoriser ou bloquer des ports spécifiques</strong> :<br />
   - Autoriser le HTTP (port 80) :
     <div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">80</span>/tcp
</span></code></pre></div>
   - Autoriser le HTTPS (port 443) :
     <div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">443</span>/tcp
</span></code></pre></div>
   - Bloquer un port :
     <div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>deny<span class="w"> </span><span class="m">21</span>/tcp
</span></code></pre></div></p>
</li>
<li>
<p><strong>Autoriser un IP ou un réseau spécifique</strong> :<br />
   - Autoriser une IP à se connecter à tout le serveur :
     <div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span>from<span class="w"> </span><span class="m">192</span>.168.1.100
</span></code></pre></div>
   - Autoriser une IP pour un port spécifique :
     <div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span>from<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span>to<span class="w"> </span>any<span class="w"> </span>port<span class="w"> </span><span class="m">22</span>
</span></code></pre></div></p>
</li>
</ol>
<hr />
<h3 id="etape-13-activer-ufw">Étape 1.3 : Activer UFW</h3>
<p>Activez UFW pour que les règles prennent effet :</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>sudo<span class="w"> </span>ufw<span class="w"> </span><span class="nb">enable</span>
</span></code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Une fois activé, toutes les connexions non autorisées seront bloquées par défaut. Sur WSL la commande peut avoir un comportement étrange, si une erreur s'affiche mais  qu'en relançant le WSL et en lançant "ufw status" vous avez un résultat cohérent c'est que la config à été prise en compte.</p>
</div>
<hr />
<h3 id="etape-14-tester-la-configuration-ufw-en-local">Étape 1.4 : Tester la configuration UFW en local</h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Si vous etes sur WSL, ignorez cette partie et allez directement à la partie 2, malheureusement le WSL n'est pas un vrai noyaux linux, ce qui rend en réalité ufw completement inopérant. Exécutez bien "sudo ufw disable" pour pouvoir continuer.</p>
</div>
<ol>
<li>
<p><strong>Vérifiez les ports autorisés</strong> :
   Utilisez <code>nmap</code> pour scanner les ports de <code>localhost</code> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>nmap
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>nmap<span class="w"> </span>localhost
</span></code></pre></div></p>
</li>
<li>
<p><strong>Tester les règles spécifiques</strong> :<br />
   - Pour tester si le port HTTP (80) est ouvert :
     <div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>curl<span class="w"> </span>http://localhost
</span></code></pre></div>
   - Pour tester un port bloqué (par exemple FTP sur 21) :
     <div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>nc<span class="w"> </span>-zv<span class="w"> </span>localhost<span class="w"> </span><span class="m">21</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Vérifiez les logs UFW</strong> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>sudo<span class="w"> </span>tail<span class="w"> </span>-f<span class="w"> </span>/var/log/ufw.log
</span></code></pre></div></p>
</li>
</ol>
<hr />
<h2 id="partie-2-utilisation-de-iptables">Partie 2 : Utilisation de iptables</h2>
<p><strong>iptables</strong> offre un contrôle plus fin sur le filtrage des paquets réseau. Cependant, il est plus complexe à utiliser.</p>
<h3 id="etape-21-verifier-si-iptables-est-installe">Étape 2.1 : Vérifier si iptables est installé</h3>
<p>Pour vérifier si iptables est disponible sur votre système :</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>sudo<span class="w"> </span>iptables<span class="w"> </span>-L
</span></code></pre></div>
<p>Si la commande retourne des chaînes de règles (INPUT, FORWARD, OUTPUT), alors iptables est actif.</p>
<hr />
<h3 id="etape-22-configurer-des-regles-simples">Étape 2.2 : Configurer des règles simples</h3>
<ol>
<li><strong>Bloquer tout le trafic entrant par défaut</strong> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>sudo<span class="w"> </span>iptables<span class="w"> </span>-P<span class="w"> </span>INPUT<span class="w"> </span>DROP
</span></code></pre></div></li>
</ol>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Vous pouvez verifier en tentant de vous reconnecter en ssh</p>
</div>
<ol>
<li>
<p><strong>Autoriser le trafic sortant</strong> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>sudo<span class="w"> </span>iptables<span class="w"> </span>-P<span class="w"> </span>OUTPUT<span class="w"> </span>ACCEPT
</span></code></pre></div></p>
</li>
<li>
<p><strong>Autoriser uniquement SSH</strong> :</p>
</li>
</ol>
<p>Si vous etes sur WSL cela ne fonctionnera pas, je vous invite à passer directement au 2.3</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>sudo<span class="w"> </span>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span></code></pre></div>
<ol>
<li><strong>Autoriser un réseau spécifique</strong> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>sudo<span class="w"> </span>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-s<span class="w"> </span><span class="m">192</span>.168.1.0/24<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span></code></pre></div></li>
</ol>
<hr />
<h3 id="etape-23-sauvegarder-et-restaurer-les-regles">Étape 2.3 : Sauvegarder et restaurer les règles</h3>
<p>Les modifications d’iptables ne sont pas persistantes par défaut. Pour sauvegarder vos règles :</p>
<ol>
<li>
<p><strong>Sauvegarder les règles actuelles</strong> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>sudo<span class="w"> </span>iptables-save<span class="w"> </span>&gt;<span class="w"> </span>/etc/iptables.rules
</span></code></pre></div></p>
</li>
<li>
<p><strong>Restaurer les règles au démarrage</strong> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>iptables-restore<span class="w"> </span>&lt;<span class="w"> </span>/etc/iptables.rules
</span></code></pre></div></p>
</li>
</ol>
<hr />
<h3 id="etape-24-tester-la-configuration-iptables-en-local">Étape 2.4 : Tester la configuration iptables en local</h3>
<p>Encore une fois si vous etes sur wsl je vous invite à simplement lire et prendre connaissance des informations ci-dessous, vous ne pourrez pas tester.
Vous pouvez néanmoins constater la différence (nmap et curl) après avoir executé.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>sudo<span class="w"> </span>iptables<span class="w"> </span>-P<span class="w"> </span>INPUT<span class="w"> </span>DROP
</span></code></pre></div>
<p>puis </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>sudo<span class="w"> </span>iptables<span class="w"> </span>-P<span class="w"> </span>INPUT<span class="w"> </span>ACCEPT
</span></code></pre></div>
<ol>
<li>
<p><strong>Vérifiez les règles appliquées</strong> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>sudo<span class="w"> </span>iptables<span class="w"> </span>-L<span class="w"> </span>-v
</span></code></pre></div></p>
</li>
<li>
<p><strong>Scanner les ports ouverts</strong> :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>nmap<span class="w"> </span>localhost
</span></code></pre></div></p>
</li>
<li>
<p><strong>Tester un port spécifique</strong> :<br />
   - Pour vérifier si le port SSH (22) est accessible :
     <div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>nc<span class="w"> </span>-zv<span class="w"> </span>localhost<span class="w"> </span><span class="m">22</span>
</span></code></pre></div>
   - Pour un port bloqué, comme le port HTTP si non autorisé :
     <div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>curl<span class="w"> </span>http://localhost
</span></code></pre></div></p>
</li>
<li>
<p><strong>Vérifiez les logs d’iptables</strong> :
   Ajoutez une règle pour journaliser les paquets rejetés :
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>sudo<span class="w"> </span>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-j<span class="w"> </span>LOG<span class="w"> </span>--log-prefix<span class="w"> </span><span class="s2">&quot;IPTables-Dropped: &quot;</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>sudo<span class="w"> </span>tail<span class="w"> </span>-f<span class="w"> </span>/var/log/kern.log
</span></code></pre></div></p>
</li>
</ol>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.prune", "navigation.indexes", "navigation.top", "navigation.path", "navigation.sections"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>